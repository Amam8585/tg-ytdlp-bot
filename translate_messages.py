#!/usr/bin/env python3
"""
Автоматический перевод сообщений для многоязычной системы
"""

import re
import os

# Словарь переводов для русского языка
RU_TRANSLATIONS = {
    # Основные сообщения
    "Downloading": "Загрузка",
    "Processing": "Обработка", 
    "Complete": "Завершено",
    "Error": "Ошибка",
    "Failed": "Не удалось",
    "Success": "Успешно",
    "Warning": "Предупреждение",
    "Info": "Информация",
    "Settings": "Настройки",
    "Help": "Помощь",
    "Close": "Закрыть",
    "Back": "Назад",
    "Next": "Далее",
    "Previous": "Предыдущий",
    "Cancel": "Отмена",
    "Confirm": "Подтвердить",
    "Save": "Сохранить",
    "Delete": "Удалить",
    "Edit": "Редактировать",
    "Add": "Добавить",
    "Remove": "Удалить",
    "Update": "Обновить",
    "Refresh": "Обновить",
    "Search": "Поиск",
    "Filter": "Фильтр",
    "Sort": "Сортировка",
    "Download": "Скачать",
    "Upload": "Загрузить",
    "Send": "Отправить",
    "Receive": "Получить",
    "Start": "Начать",
    "Stop": "Остановить",
    "Pause": "Пауза",
    "Resume": "Продолжить",
    "Retry": "Повторить",
    "Continue": "Продолжить",
    "Finish": "Завершить",
    "Complete": "Завершено",
    "Done": "Готово",
    "Ready": "Готов",
    "Loading": "Загрузка",
    "Waiting": "Ожидание",
    "Please wait": "Пожалуйста, подождите",
    "Please try again": "Пожалуйста, попробуйте снова",
    "Try again": "Попробуйте снова",
    "Invalid": "Неверный",
    "Valid": "Действительный",
    "Available": "Доступно",
    "Unavailable": "Недоступно",
    "Enabled": "Включено",
    "Disabled": "Отключено",
    "On": "Вкл",
    "Off": "Выкл",
    "Yes": "Да",
    "No": "Нет",
    "OK": "ОК",
    "Cancel": "Отмена",
    "Apply": "Применить",
    "Reset": "Сбросить",
    "Default": "По умолчанию",
    "Custom": "Пользовательский",
    "Auto": "Авто",
    "Manual": "Ручной",
    "Automatic": "Автоматический",
    "Quality": "Качество",
    "Format": "Формат",
    "Size": "Размер",
    "Duration": "Длительность",
    "Title": "Название",
    "Description": "Описание",
    "Name": "Имя",
    "Type": "Тип",
    "Status": "Статус",
    "Progress": "Прогресс",
    "Speed": "Скорость",
    "Time": "Время",
    "Date": "Дата",
    "File": "Файл",
    "Folder": "Папка",
    "Directory": "Каталог",
    "Path": "Путь",
    "URL": "URL",
    "Link": "Ссылка",
    "Video": "Видео",
    "Audio": "Аудио",
    "Image": "Изображение",
    "Photo": "Фото",
    "Picture": "Картинка",
    "Media": "Медиа",
    "Content": "Контент",
    "Data": "Данные",
    "Information": "Информация",
    "Details": "Детали",
    "Options": "Опции",
    "Preferences": "Предпочтения",
    "Configuration": "Конфигурация",
    "Setup": "Настройка",
    "Installation": "Установка",
    "Update": "Обновление",
    "Upgrade": "Обновление",
    "Version": "Версия",
    "Release": "Релиз",
    "Build": "Сборка",
    "Development": "Разработка",
    "Production": "Продакшн",
    "Testing": "Тестирование",
    "Debug": "Отладка",
    "Log": "Лог",
    "Logs": "Логи",
    "History": "История",
    "Record": "Запись",
    "Entry": "Запись",
    "Item": "Элемент",
    "List": "Список",
    "Menu": "Меню",
    "Button": "Кнопка",
    "Link": "Ссылка",
    "Text": "Текст",
    "Message": "Сообщение",
    "Notification": "Уведомление",
    "Alert": "Предупреждение",
    "Warning": "Предупреждение",
    "Error": "Ошибка",
    "Exception": "Исключение",
    "Bug": "Ошибка",
    "Issue": "Проблема",
    "Problem": "Проблема",
    "Solution": "Решение",
    "Fix": "Исправление",
    "Repair": "Ремонт",
    "Restore": "Восстановить",
    "Backup": "Резервная копия",
    "Copy": "Копия",
    "Paste": "Вставить",
    "Cut": "Вырезать",
    "Undo": "Отменить",
    "Redo": "Повторить",
    "Select": "Выбрать",
    "Choose": "Выбрать",
    "Pick": "Выбрать",
    "Option": "Опция",
    "Choice": "Выбор",
    "Alternative": "Альтернатива",
    "Variant": "Вариант",
    "Mode": "Режим",
    "State": "Состояние",
    "Condition": "Условие",
    "Requirement": "Требование",
    "Necessity": "Необходимость",
    "Need": "Нужно",
    "Want": "Хочу",
    "Like": "Нравится",
    "Prefer": "Предпочитать",
    "Recommend": "Рекомендовать",
    "Suggest": "Предлагать",
    "Advise": "Советовать",
    "Tip": "Совет",
    "Hint": "Подсказка",
    "Clue": "Подсказка",
    "Guide": "Руководство",
    "Manual": "Руководство",
    "Instructions": "Инструкции",
    "Steps": "Шаги",
    "Process": "Процесс",
    "Procedure": "Процедура",
    "Method": "Метод",
    "Way": "Способ",
    "Approach": "Подход",
    "Strategy": "Стратегия",
    "Plan": "План",
    "Schedule": "Расписание",
    "Timeline": "Временная шкала",
    "Deadline": "Срок",
    "Due": "Срок",
    "Expired": "Истек",
    "Valid": "Действительный",
    "Invalid": "Недействительный",
    "Expired": "Истекший",
    "Active": "Активный",
    "Inactive": "Неактивный",
    "Online": "Онлайн",
    "Offline": "Офлайн",
    "Connected": "Подключен",
    "Disconnected": "Отключен",
    "Available": "Доступен",
    "Unavailable": "Недоступен",
    "Busy": "Занят",
    "Free": "Свободен",
    "Open": "Открыт",
    "Closed": "Закрыт",
    "Locked": "Заблокирован",
    "Unlocked": "Разблокирован",
    "Secure": "Безопасный",
    "Safe": "Безопасный",
    "Dangerous": "Опасный",
    "Risky": "Рискованный",
    "Important": "Важный",
    "Critical": "Критический",
    "Urgent": "Срочный",
    "Priority": "Приоритет",
    "High": "Высокий",
    "Low": "Низкий",
    "Medium": "Средний",
    "Normal": "Обычный",
    "Standard": "Стандартный",
    "Basic": "Базовый",
    "Advanced": "Продвинутый",
    "Expert": "Эксперт",
    "Professional": "Профессиональный",
    "Beginner": "Новичок",
    "Intermediate": "Средний",
    "Expert": "Эксперт",
    "User": "Пользователь",
    "Admin": "Администратор",
    "Moderator": "Модератор",
    "Guest": "Гость",
    "Member": "Участник",
    "Subscriber": "Подписчик",
    "Customer": "Клиент",
    "Client": "Клиент",
    "Server": "Сервер",
    "Service": "Сервис",
    "System": "Система",
    "Application": "Приложение",
    "Program": "Программа",
    "Software": "Программное обеспечение",
    "Hardware": "Оборудование",
    "Device": "Устройство",
    "Machine": "Машина",
    "Computer": "Компьютер",
    "Mobile": "Мобильный",
    "Desktop": "Настольный",
    "Laptop": "Ноутбук",
    "Tablet": "Планшет",
    "Phone": "Телефон",
    "Smartphone": "Смартфон",
    "Browser": "Браузер",
    "Website": "Веб-сайт",
    "Webpage": "Веб-страница",
    "Page": "Страница",
    "Site": "Сайт",
    "Domain": "Домен",
    "Network": "Сеть",
    "Internet": "Интернет",
    "Connection": "Соединение",
    "Bandwidth": "Пропускная способность",
    "Speed": "Скорость",
    "Latency": "Задержка",
    "Ping": "Пинг",
    "Timeout": "Таймаут",
    "Retry": "Повторить",
    "Attempt": "Попытка",
    "Trial": "Попытка",
    "Test": "Тест",
    "Check": "Проверить",
    "Verify": "Проверить",
    "Validate": "Проверить",
    "Confirm": "Подтвердить",
    "Approve": "Одобрить",
    "Reject": "Отклонить",
    "Accept": "Принять",
    "Decline": "Отклонить",
    "Allow": "Разрешить",
    "Deny": "Запретить",
    "Block": "Заблокировать",
    "Unblock": "Разблокировать",
    "Enable": "Включить",
    "Disable": "Отключить",
    "Activate": "Активировать",
    "Deactivate": "Деактивировать",
    "Start": "Запустить",
    "Stop": "Остановить",
    "Pause": "Приостановить",
    "Resume": "Возобновить",
    "Restart": "Перезапустить",
    "Reload": "Перезагрузить",
    "Refresh": "Обновить",
    "Update": "Обновить",
    "Upgrade": "Обновить",
    "Downgrade": "Понизить",
    "Install": "Установить",
    "Uninstall": "Удалить",
    "Remove": "Удалить",
    "Delete": "Удалить",
    "Clear": "Очистить",
    "Reset": "Сбросить",
    "Restore": "Восстановить",
    "Backup": "Резервная копия",
    "Recover": "Восстановить",
    "Repair": "Исправить",
    "Fix": "Исправить",
    "Solve": "Решить",
    "Resolve": "Решить",
    "Handle": "Обработать",
    "Process": "Обработать",
    "Execute": "Выполнить",
    "Run": "Запустить",
    "Launch": "Запустить",
    "Open": "Открыть",
    "Close": "Закрыть",
    "Exit": "Выход",
    "Quit": "Выход",
    "End": "Конец",
    "Finish": "Завершить",
    "Complete": "Завершить",
    "Done": "Готово",
    "Ready": "Готов",
    "Available": "Доступно",
    "Unavailable": "Недоступно",
    "Online": "Онлайн",
    "Offline": "Офлайн",
    "Connected": "Подключен",
    "Disconnected": "Отключен",
    "Active": "Активен",
    "Inactive": "Неактивен",
    "Enabled": "Включен",
    "Disabled": "Отключен",
    "On": "Вкл",
    "Off": "Выкл",
    "Yes": "Да",
    "No": "Нет",
    "True": "Истина",
    "False": "Ложь",
    "Null": "Пусто",
    "Empty": "Пусто",
    "Full": "Полно",
    "Partial": "Частично",
    "Complete": "Полностью",
    "Incomplete": "Неполно",
    "Valid": "Действительно",
    "Invalid": "Недействительно",
    "Correct": "Правильно",
    "Incorrect": "Неправильно",
    "Right": "Правильно",
    "Wrong": "Неправильно",
    "Good": "Хорошо",
    "Bad": "Плохо",
    "Better": "Лучше",
    "Worse": "Хуже",
    "Best": "Лучший",
    "Worst": "Худший",
    "New": "Новый",
    "Old": "Старый",
    "Recent": "Недавний",
    "Latest": "Последний",
    "Current": "Текущий",
    "Previous": "Предыдущий",
    "Next": "Следующий",
    "First": "Первый",
    "Last": "Последний",
    "Second": "Второй",
    "Third": "Третий",
    "Fourth": "Четвертый",
    "Fifth": "Пятый",
    "Sixth": "Шестой",
    "Seventh": "Седьмой",
    "Eighth": "Восьмой",
    "Ninth": "Девятый",
    "Tenth": "Десятый",
    "One": "Один",
    "Two": "Два",
    "Three": "Три",
    "Four": "Четыре",
    "Five": "Пять",
    "Six": "Шесть",
    "Seven": "Семь",
    "Eight": "Восемь",
    "Nine": "Девять",
    "Ten": "Десять",
    "Eleven": "Одиннадцать",
    "Twelve": "Двенадцать",
    "Thirteen": "Тринадцать",
    "Fourteen": "Четырнадцать",
    "Fifteen": "Пятнадцать",
    "Sixteen": "Шестнадцать",
    "Seventeen": "Семнадцать",
    "Eighteen": "Восемнадцать",
    "Nineteen": "Девятнадцать",
    "Twenty": "Двадцать",
    "Thirty": "Тридцать",
    "Forty": "Сорок",
    "Fifty": "Пятьдесят",
    "Sixty": "Шестьдесят",
    "Seventy": "Семьдесят",
    "Eighty": "Восемьдесят",
    "Ninety": "Девяносто",
    "Hundred": "Сто",
    "Thousand": "Тысяча",
    "Million": "Миллион",
    "Billion": "Миллиард",
    "Trillion": "Триллион",
    "Zero": "Ноль",
    "None": "Никто",
    "All": "Все",
    "Some": "Некоторые",
    "Many": "Много",
    "Few": "Мало",
    "Little": "Мало",
    "Much": "Много",
    "More": "Больше",
    "Less": "Меньше",
    "Most": "Большинство",
    "Least": "Наименьший",
    "Enough": "Достаточно",
    "Too much": "Слишком много",
    "Too little": "Слишком мало",
    "Too many": "Слишком много",
    "Too few": "Слишком мало",
    "Very": "Очень",
    "Quite": "Довольно",
    "Rather": "Скорее",
    "Pretty": "Довольно",
    "Fairly": "Довольно",
    "Somewhat": "Немного",
    "Slightly": "Слегка",
    "Hardly": "Едва",
    "Barely": "Едва",
    "Almost": "Почти",
    "Nearly": "Почти",
    "About": "Около",
    "Around": "Около",
    "Approximately": "Примерно",
    "Exactly": "Точно",
    "Precisely": "Точно",
    "Roughly": "Примерно",
    "Nearly": "Почти",
    "Almost": "Почти",
    "Just": "Только",
    "Only": "Только",
    "Even": "Даже",
    "Still": "Все еще",
    "Yet": "Еще",
    "Already": "Уже",
    "Soon": "Скоро",
    "Later": "Позже",
    "Earlier": "Раньше",
    "Before": "До",
    "After": "После",
    "During": "Во время",
    "While": "Пока",
    "Since": "С тех пор",
    "Until": "До",
    "From": "От",
    "To": "К",
    "At": "В",
    "In": "В",
    "On": "На",
    "Under": "Под",
    "Over": "Над",
    "Above": "Выше",
    "Below": "Ниже",
    "Between": "Между",
    "Among": "Среди",
    "Through": "Через",
    "Across": "Через",
    "Along": "Вдоль",
    "Around": "Вокруг",
    "Behind": "За",
    "Beside": "Рядом",
    "Near": "Рядом",
    "Far": "Далеко",
    "Close": "Близко",
    "Distant": "Далекий",
    "Local": "Локальный",
    "Remote": "Удаленный",
    "Global": "Глобальный",
    "International": "Международный",
    "National": "Национальный",
    "Regional": "Региональный",
    "Local": "Местный",
    "Public": "Публичный",
    "Private": "Приватный",
    "Personal": "Личный",
    "Individual": "Индивидуальный",
    "Group": "Группа",
    "Team": "Команда",
    "Organization": "Организация",
    "Company": "Компания",
    "Business": "Бизнес",
    "Enterprise": "Предприятие",
    "Corporation": "Корпорация",
    "Firm": "Фирма",
    "Office": "Офис",
    "Department": "Отдел",
    "Division": "Подразделение",
    "Section": "Секция",
    "Unit": "Единица",
    "Part": "Часть",
    "Piece": "Кусок",
    "Bit": "Бит",
    "Byte": "Байт",
    "Kilobyte": "Килобайт",
    "Megabyte": "Мегабайт",
    "Gigabyte": "Гигабайт",
    "Terabyte": "Терабайт",
    "Petabyte": "Петабайт",
    "Exabyte": "Эксабайт",
    "Zettabyte": "Зеттабайт",
    "Yottabyte": "Йоттабайт",
    "Bit": "Бит",
    "Byte": "Байт",
    "Word": "Слово",
    "Character": "Символ",
    "String": "Строка",
    "Text": "Текст",
    "Data": "Данные",
    "Information": "Информация",
    "Content": "Содержимое",
    "Material": "Материал",
    "Substance": "Вещество",
    "Matter": "Материя",
    "Object": "Объект",
    "Subject": "Предмет",
    "Topic": "Тема",
    "Theme": "Тема",
    "Subject": "Предмет",
    "Issue": "Вопрос",
    "Problem": "Проблема",
    "Question": "Вопрос",
    "Answer": "Ответ",
    "Reply": "Ответ",
    "Response": "Ответ",
    "Reaction": "Реакция",
    "Feedback": "Обратная связь",
    "Comment": "Комментарий",
    "Note": "Заметка",
    "Remark": "Замечание",
    "Observation": "Наблюдение",
    "Opinion": "Мнение",
    "View": "Взгляд",
    "Perspective": "Перспектива",
    "Aspect": "Аспект",
    "Side": "Сторона",
    "Part": "Часть",
    "Component": "Компонент",
    "Element": "Элемент",
    "Factor": "Фактор",
    "Feature": "Особенность",
    "Characteristic": "Характеристика",
    "Property": "Свойство",
    "Attribute": "Атрибут",
    "Quality": "Качество",
    "Value": "Значение",
    "Amount": "Количество",
    "Quantity": "Количество",
    "Number": "Число",
    "Count": "Счет",
    "Total": "Всего",
    "Sum": "Сумма",
    "Average": "Среднее",
    "Mean": "Среднее",
    "Median": "Медиана",
    "Mode": "Режим",
    "Range": "Диапазон",
    "Minimum": "Минимум",
    "Maximum": "Максимум",
    "Limit": "Лимит",
    "Boundary": "Граница",
    "Edge": "Край",
    "Border": "Граница",
    "Margin": "Отступ",
    "Padding": "Отступ",
    "Space": "Пространство",
    "Gap": "Промежуток",
    "Distance": "Расстояние",
    "Length": "Длина",
    "Width": "Ширина",
    "Height": "Высота",
    "Depth": "Глубина",
    "Thickness": "Толщина",
    "Size": "Размер",
    "Dimension": "Размерность",
    "Area": "Площадь",
    "Volume": "Объем",
    "Weight": "Вес",
    "Mass": "Масса",
    "Density": "Плотность",
    "Speed": "Скорость",
    "Velocity": "Скорость",
    "Acceleration": "Ускорение",
    "Force": "Сила",
    "Power": "Мощность",
    "Energy": "Энергия",
    "Work": "Работа",
    "Time": "Время",
    "Duration": "Продолжительность",
    "Period": "Период",
    "Interval": "Интервал",
    "Frequency": "Частота",
    "Rate": "Скорость",
    "Ratio": "Соотношение",
    "Percentage": "Процент",
    "Proportion": "Пропорция",
    "Fraction": "Дробь",
    "Decimal": "Десятичный",
    "Integer": "Целое число",
    "Float": "Плавающая точка",
    "Double": "Двойная точность",
    "Boolean": "Булевый",
    "String": "Строка",
    "Array": "Массив",
    "List": "Список",
    "Set": "Множество",
    "Map": "Карта",
    "Dictionary": "Словарь",
    "Table": "Таблица",
    "Row": "Строка",
    "Column": "Столбец",
    "Cell": "Ячейка",
    "Field": "Поле",
    "Record": "Запись",
    "Entry": "Запись",
    "Item": "Элемент",
    "Node": "Узел",
    "Vertex": "Вершина",
    "Edge": "Ребро",
    "Graph": "Граф",
    "Tree": "Дерево",
    "Forest": "Лес",
    "Network": "Сеть",
    "Grid": "Сетка",
    "Matrix": "Матрица",
    "Vector": "Вектор",
    "Point": "Точка",
    "Line": "Линия",
    "Curve": "Кривая",
    "Surface": "Поверхность",
    "Plane": "Плоскость",
    "Space": "Пространство",
    "Dimension": "Измерение",
    "Axis": "Ось",
    "Coordinate": "Координата",
    "Position": "Позиция",
    "Location": "Местоположение",
    "Place": "Место",
    "Spot": "Место",
    "Point": "Точка",
    "Area": "Область",
    "Region": "Регион",
    "Zone": "Зона",
    "Territory": "Территория",
    "Country": "Страна",
    "State": "Штат",
    "Province": "Провинция",
    "City": "Город",
    "Town": "Город",
    "Village": "Деревня",
    "Street": "Улица",
    "Road": "Дорога",
    "Path": "Путь",
    "Route": "Маршрут",
    "Way": "Путь",
    "Direction": "Направление",
    "Course": "Курс",
    "Bearing": "Азимут",
    "Heading": "Заголовок",
    "Orientation": "Ориентация",
    "Alignment": "Выравнивание",
    "Position": "Позиция",
    "Location": "Местоположение",
    "Place": "Место",
    "Spot": "Место",
    "Point": "Точка",
    "Area": "Область",
    "Region": "Регион",
    "Zone": "Зона",
    "Territory": "Территория",
    "Country": "Страна",
    "State": "Штат",
    "Province": "Провинция",
    "City": "Город",
    "Town": "Город",
    "Village": "Деревня",
    "Street": "Улица",
    "Road": "Дорога",
    "Path": "Путь",
    "Route": "Маршрут",
    "Way": "Путь",
    "Direction": "Направление",
    "Course": "Курс",
    "Bearing": "Азимут",
    "Heading": "Заголовок",
    "Orientation": "Ориентация",
    "Alignment": "Выравнивание"
}

def translate_text(text, translations):
    """Переводит текст используя словарь переводов"""
    if not text or not isinstance(text, str):
        return text
    
    # Исключаем строки с плейсхолдерами и техническими переменными
    exclude_patterns = [
        r'\{[^}]+\}',  # {variable}, {error}, {attempt} и т.д.
        r'FIREBASE_',  # FIREBASE_CONF, FIREBASE_USER и т.д.
        r'Config\.',   # Config.BOT_NAME и т.д.
        r'@[a-zA-Z_]+',  # @username, @bot_name и т.д.
        r'https?://',  # URL
        r'<[^>]+>',    # HTML теги
        r'`[^`]+`',    # Код в backticks
        r'[A-Z_]+_[A-Z_]+',  # Константы типа ERROR_MSG
    ]
    
    # Проверяем, содержит ли строка исключаемые паттерны
    for pattern in exclude_patterns:
        if re.search(pattern, text):
            return text  # Не переводим
    
    # Простой поиск и замена
    result = text
    for english, russian in translations.items():
        # Заменяем только целые слова, но не внутри фигурных скобок
        pattern = r'\b' + re.escape(english) + r'\b'
        result = re.sub(pattern, russian, result, flags=re.IGNORECASE)
    
    return result

def translate_messages_file(file_path, translations):
    """Переводит файл сообщений"""
    if not os.path.exists(file_path):
        print(f"Файл не найден: {file_path}")
        return
    
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # Находим все строки с переменными (более точный паттерн)
    pattern = r'(\w+_MSG) = "([^"]*(?:\\.[^"]*)*)"'
    matches = re.findall(pattern, content)
    
    translated_count = 0
    for var_name, text in matches:
        # Пропускаем технические переменные
        if any(tech in var_name for tech in ['FIREBASE_', 'Config.', 'ADMIN_', 'DB_', 'MAGIC_']):
            continue
            
        # Пропускаем переменные с плейсхолдерами
        if re.search(r'\{[^}]+\}', text):
            continue
            
        translated_text = translate_text(text, translations)
        if translated_text != text:
            # Заменяем в содержимом
            old_line = f'{var_name} = "{text}"'
            new_line = f'{var_name} = "{translated_text}"'
            content = content.replace(old_line, new_line)
            translated_count += 1
            print(f"Переведено: {var_name}")
    
    # Сохраняем переведенный файл
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    print(f"Переведено {translated_count} переменных в {file_path}")

if __name__ == "__main__":
    # Переводим русский файл
    ru_file = "/mnt/c/Users/chelaxian/Desktop/tg-ytdlp-NEW/CONFIG/LANGUAGES/messages_RU.py"
    translate_messages_file(ru_file, RU_TRANSLATIONS)
